# AudioRecorderModule Testing Matrix

**Branch:** `refactor/audio-segmentation-avduration`
**Build/Version:** (Specify app version/build used for testing)
**Tester:** (Your Name)
**Date:** (Date of Testing)

## I. Core Functionality & Segmentation

| Test Case ID | Scenario                                       | Steps to Reproduce                                                                                                                               | Expected Result                                                                                                                                                                                            | Actual Result | Status (Pass/Fail) | Notes                                            |
| :----------- | :--------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :----------------------------------------------- |
| TC-CORE-001  | Short Recording (less than 1 segment)          | 1. Start recording. 2. Wait ~30 seconds. 3. Stop recording.                                                                                      | Recording completes. `onRecordingFinished` event fires with correct total duration & 1 segment path. File is playable. `totalDurationOfCompletedSegmentsSoFar` is 0. `currentRecordingDuration` reflects actual time. |               |                    |                                                  |
| TC-CORE-002  | Single Full Segment (timed completion)         | 1. Set `maxSegmentDuration` (e.g., to 1 minute for testing). 2. Start recording. 3. Let it run past `maxSegmentDuration`.                         | Recording stops automatically after `maxSegmentDuration`. `onRecordingSegmentComplete` fires. `onRecordingFinished` fires. Correct duration. 1 segment path. File playable.                                              |               |                    |                                                  |
| TC-CORE-003  | Multiple Segments (timed completion)         | 1. Set `maxSegmentDuration` (e.g., to 30 seconds). 2. Start recording. 3. Let it run for ~75 seconds. 4. Stop recording.                            | Two `onRecordingSegmentComplete` events. `onRecordingFinished` with 3 segments. `totalDurationOfCompletedSegmentsSoFar` correct. Files playable. Correct total duration.                                                    |               |                    |                                                  |
| TC-CORE-004  | Multiple Segments (manual stop mid-segment)  | 1. Set `maxSegmentDuration` (e.g., to 30 seconds). 2. Start recording. 3. Let it run for ~45 seconds (1 full segment, 1 partial). 4. Stop recording. | One `onRecordingSegmentComplete` (for full segment). `onRecordingFinished` with 2 segments. Correct total duration. Files playable.                                                                                        |               |                    |                                                  |
| TC-CORE-005  | Progress Updates (`onRecordingProgress`)       | 1. Start recording. 2. Monitor emitted `onRecordingProgress` events (e.g., via console logs).                                                    | Events fire regularly (e.g., every second). `currentTime` in event should be `totalDurationOfCompletedSegmentsSoFar + current_segment_recorder.currentTime` and increase monotonically. Segment number correct.          |               |                    |                                                  |
| TC-CORE-006  | Filename Format                                | 1. Perform a recording that spans at least one segment. 2. Inspect saved filenames.                                                            | Filenames include ISO-8601 timestamp (UTC) and segment number (e.g., `rec_<recordingID>_<YYYYMMDDTHHMMSSZ>_segment<number>.m4a`).                                                                        |               |                    |                                                  |

## II. Pause & Resume Functionality

| Test Case ID | Scenario                                      | Steps to Reproduce                                                                                                                                  | Expected Result                                                                                                                                                                                                                                | Actual Result | Status (Pass/Fail) | Notes                                                                          |
| :----------- | :-------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :----------------------------------------------------------------------------- |
| TC-PR-001    | Pause/Resume (within one segment)             | 1. Start recording. 2. Wait ~10s. 3. Pause. (`onRecordingPaused` event). 4. Wait ~5s. 5. Resume. (`onRecordingResumed` event). 6. Wait ~10s. 7. Stop. | Recording pauses and resumes. Total recorded audio duration should exclude the 5s paused time. Progress updates reflect pause. Final file correct.                                                                                             |               |                    |                                                                                |
| TC-PR-002    | Pause/Resume (across segment boundary)        | 1. Set `maxSegmentDuration` (e.g., 30s). 2. Start. 3. Wait ~25s. 4. Pause. 5. Wait ~5s. 6. Resume. 7. Let it run for ~20s (into next segment). 8. Stop. | Pauses. Resumes into a new segment correctly. `onRecordingSegmentComplete` for first segment. Total duration correct.                                                                                                                             |               |                    | Verify `totalDurationOfCompletedSegmentsSoFar` and `totalPauseDuration` values. |
| TC-PR-003    | Multiple Pause/Resume                         | 1. Start recording. 2. Pause/Resume several times. 3. Stop.                                                                                         | Behaves correctly for each pause/resume cycle. Final audio is coherent. Total recorded duration accurate.                                                                                                                                      |               |                    |                                                                                |
| TC-PR-004    | Stop while Paused                             | 1. Start recording. 2. Pause. 3. Stop recording while still paused.                                                                                 | Recording stops cleanly. `onRecordingFinished` fires with correct data (duration reflects pre-pause recording). `totalPauseDuration` should be captured.                                                                                     |               |                    |                                                                                |

## III. App Lifecycle & Interruptions

| Test Case ID | Scenario                                   | Steps to Reproduce                                                                                                                                                            | Expected Result                                                                                                                                                                                                                                                            | Actual Result | Status (Pass/Fail) | Notes                                                                                    |
| :----------- | :----------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :--------------------------------------------------------------------------------------- |
| TC-LIFE-001  | Background then Foreground (Recording)     | 1. Start recording. 2. Background app. 3. Wait ~10s. 4. Foreground app. 5. Continue recording ~10s. 6. Stop.                                                                   | Recording continues seamlessly in background. Upon foregrounding, UI reflects correct state. `onRecordingPausedBySystem` (or similar like `paused-by-background`) then `onRecordingResumedBySystem` (or `resumed-from-background`) events. Final audio correct.                                            |               |                    |                                                                                          |
| TC-LIFE-002  | Background then Foreground (Paused)        | 1. Start recording. 2. Pause (user). 3. Background app. 4. Wait ~10s. 5. Foreground app. 6. Resume (user). 7. Stop.                                                              | State remains paused in background. Resumes correctly when user initiates. No automatic resume from foregrounding if user paused.                                                                                                                                              |               |                    |                                                                                          |
| TC-LIFE-003  | Audio Interruption (e.g., Phone Call Start)  | 1. Start recording. 2. Simulate incoming call / trigger audio session interruption.                                                                                           | Recording pauses automatically. `paused-by-interruption` event (or similar). `currentPauseOrigin` is `PauseOriginInterruption`.                                                                                                                                      |               |                    | (May need to simulate programmatically or via device features if manual call is hard)    |
| TC-LIFE-004  | Audio Interruption (Call End - Resume)     | 1. (After TC-LIFE-003) End simulated call / resolve interruption with resume hint.                                                                                              | Recording resumes automatically if system suggests. `resumed-from-interruption` event. `currentPauseOrigin` resets.                                                                                                                                                    |               |                    |                                                                                          |
| TC-LIFE-005  | Audio Interruption (Call End - No Resume)  | 1. (After TC-LIFE-003) End simulated call / resolve interruption *without* resume hint.                                                                                         | Recording remains paused. User must manually resume or stop.                                                                                                                                                                                                                   |               |                    |                                                                                          |

## IV. Permissions & Resource Constraints

| Test Case ID | Scenario                                     | Steps to Reproduce                                                                                                                     | Expected Result                                                                                                                                | Actual Result | Status (Pass/Fail) | Notes                                                            |
| :----------- | :------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :--------------------------------------------------------------- |
| TC-RES-001   | Microphone Permission Denied (Initial)     | 1. Revoke mic permission (if possible, via settings). 2. Attempt to start recording.                                                   | `startRecording` promise rejects with `E_PERMISSION_DENIED`. No recording starts.                                                            |               |                    |                                                                  |
| TC-RES-002   | Microphone Permission Granted (Initial)    | 1. Ensure mic permission granted. 2. Start recording.                                                                                  | Recording starts normally.                                                                                                                     |               |                    |                                                                  |
| TC-RES-003   | Low Disk Space (Before Recording)          | 1. (Simulate if possible) Reduce available disk space to below threshold (e.g., <100MB). 2. Attempt to start recording.                   | `startRecording` promise rejects with `E_DISK_SPACE_LOW`. No recording starts.                                                               |               |                    | (Hard to test accurately without a dev environment for disk fill) |
| TC-RES-004   | Low Disk Space (During Segment Transition) | 1. Start recording with sufficient space. 2. (Simulate if possible) Reduce disk space below threshold *before* a new segment starts.       | Current segment finishes. Recording stops before new segment. `onRecordingFinished` with error or specific code. `handleCriticalRecordingErrorAndStop` is called. |               |                    | (Hard to test)                                                   |

## V. Stress & Rapid Operations

| Test Case ID | Scenario                                | Steps to Reproduce                                                                    | Expected Result                                                                          | Actual Result | Status (Pass/Fail) | Notes                                       |
| :----------- | :-------------------------------------- | :------------------------------------------------------------------------------------ | :--------------------------------------------------------------------------------------- | :------------ | :----------------- | :------------------------------------------ |
| TC-STRS-001  | Rapid Start/Stop                        | 1. Tap Start, then immediately Stop. Repeat 5-10 times quickly.                       | App remains stable. No crashes. Promises resolve/reject correctly. Files created/cleaned. |               |                    | Look for race conditions, memory leaks.     |
| TC-STRS-002  | Rapid Start/Pause/Resume/Stop         | 1. Perform sequence quickly: Start -> Pause -> Resume -> Stop. Repeat 5-10 times.     | App remains stable. State transitions correctly. Events fire as expected.                |               |                    |                                             |
| TC-STRS-003  | Rapid Pause/Resume                      | 1. Start recording. 2. Tap Pause, then immediately Resume. Repeat 5-10 times quickly. | App stable. Audio correctly reflects pauses.                                             |               |                    |                                             |

## VI. Long Duration Test

| Test Case ID | Scenario                | Steps to Reproduce                                                                  | Expected Result                                                                                                 | Actual Result | Status (Pass/Fail) | Notes |
| :----------- | :---------------------- | :---------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------- | :------------ | :----------------- | :---- |
| TC-LONG-001  | Extended Recording (1hr+) | 1. Start recording. 2. Leave app recording (can be backgrounded) for 1+ hour. 3. Stop. | Recording completes successfully. Multiple segments created. Audio is coherent. No unexpected stops or crashes. |               |                    |       |
